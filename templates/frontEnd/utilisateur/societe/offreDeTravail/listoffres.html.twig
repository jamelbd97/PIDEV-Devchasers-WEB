{% extends '/frontEnd/base.html.twig' %}
{% block content %}
    <section class="bg-home"
             style="background: url('https://via.placeholder.com/2000X1333//88929f/5a6270C/O https://placeholder.com/') center center;">
        <div class="bg-overlay"></div>
        <div class="home-center">
            <div class="home-desc-center">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-lg-12">
                            <div class="title-heading text-center text-white">
                                <h1 class="heading font-weight-bold mb-4">Offres de travail</h1>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="col-md-10 p-5">
        <table id="tableau" border="2" class="table">
            <tr>
                {% set labels =["ID"] %}

                <td><b>ID</b></td>
                <td><b>Job</b></td>
                <td><b>Description</b></td>
                <td><b>Categories</b></td>
                <td><b>Actions</b></td>
                {% for offres in Offre %}
            </tr>
            <tr>

                <td>{{ offres.id }}</td>
                <td>{{ offres.job }}</td>
                <td>{{ offres.description }}</td>
                <td>{{ offres.categorie.nomCategorie }}</td>
                <td>
                    <a href="{{ asset('/societe={idSociete}/offreDeTravail={idOffreDeTravail}/utilisateur={idUtilisateur}/ajouter') }}">Postuler</a>
                    <a href="{{ asset('/modifier/'~offres.id~'/') }}">Modifier</a>
                    <a href="{{ asset('/delete/'~offres.id~'/') }}">Supprimer</a>
                </td>

            </tr>
            {% endfor %}

        </table>
        <div class="navigation">
            {{ knp_pagination_render(Offre) }}
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#recherche").keyup(function () {
                var value = $("#recherche").val();
                $.ajax({
                    url: "searchOffre",
                    type: 'GET',
                    data: {
                        'searchValue': value
                    },
                    success: function (retour) {
                        if (retour) {
                            $.each(JSON.parse(retour), function (i, obj) {
                                $('#tableau').empty().append("<tr><td>" + obj.id +
                                    "</td><td>" + obj.job + "</td><td>" + obj.description + "</td><td><a" +
                                    "href='modifier/" + obj.id + ">modifier</a> <a" +
                                    "href='delete/" + obj.id + ">supprimer</a></td></tr>");
                            });
                        } else
                            $('#tableau').empty().fadeIn('fast');
                    }
                });
            });
            return false;
        });
    </script>
{% endblock %}